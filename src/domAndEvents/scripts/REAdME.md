# Загрузка скриптов

## 1) Основные способы загрузки скриптов

### 1.1) Через тег` <script>` в HTML

- Скрипт можно подключить в HTML с помощью тега `<script>`.
- Два варианта:
  - Встроенный скрипт:
  ```html
  <script>
    console.log('Встроенный скрипт');
  </script>
  ```
  - Внешний скрипт:
  ```html
  <script src="script.js">
    console.log('Встроенный скрипт'); // это проигнорируется
  </script>
  ```

Особенности:
- Скрипты по умолчанию загружаются и выполняются синхронно, блокируя парсинг HTML до завершения загрузки и выполнения.
- Расположение тега `<script>` в HTML влияет на момент выполнения:
  - В `<head>` — выполняется до загрузки DOM, может потребоваться DOMContentLoaded.
  - В конце `<body>` — выполняется после загрузки DOM (рекомендуемый подход).
  
### 1.2) Динамическая загрузка скриптов

- Скрипты можно добавлять в DOM через JavaScript.
- Используется для асинхронной или условной загрузки.

```js
const script = document.createElement('script');
script.src = 'script.js';
script.async = true; // Асинхронная загрузка
document.body.appendChild(script);

// Обработка событий
script.onload = () => console.log('Скрипт загружен');
script.onerror = () => console.log('Ошибка загрузки');
```
Особенности:
- Позволяет загружать скрипты по событию (например, клик пользователя).
- Требует обработки ошибок (`onerror`) и успешной загрузки (`onload`).

## 2) Атрибуты тега `<script>`

Скрипты выполняющиеся последовательно остаются проблемой. И не все скрипты действительно важны для пользователя, такие как скприпты аналитики и `РЕКЛАМЫ`, например. Идеи? Можно загружать их асинхронно.

Атрибуты `defer` и `async` были придуманы специально для этого, чтобы дать возможность разработчикам указать какие скрипты можно загружать асинхронно.

Оба этих атрибута подскажут браузеру, что он может продолжить парсить HTML и в тоже время загрузить эти скрипты в фоне. При таком раскладе, скрипты не будут блокировать постройку DOM и рендеринг, в результате чего, пользователь увидит страницу ещё до того, как все скрипты загрузятся.

Разница между `defer` и `async` в том, что они начинают выполнять скрипты в разный момент времени.

`defer` появился раньше `async`. Скрипты с этим атрибутом выполняются после того, как парсинг полностью завершён, но перед событием `DOMContentLoaded`. Они гарантировано будут запущены в порядке, в котором они находятся на странице и не будут блокировать парсер.

Скрипты с `async` же будут выполнены при первой же возможности после того как будут загружены и перед событием `load` у `window`. Это значит, что возможно (и скорее всего наверняка) скрипты с async будут выполнены не в порядке их появления в HTML. Это так же значит, что они могут блокировать постройку DOM.

Где бы они не были указаны, скрипты с `async` загружаются с низким приоритетом, зачастую после всех остальных скриптов, без блокирования постройки DOM. Но если скрипт с `async` загрузится быстрее, то его выполнение может заблокировать постройку DOM и все остальные скрипты, которым только предстоит загрузиться.

**Замечание**: атрибуты `async` и `defer` работают только для внешних скриптов. Без параметра `src` они будут проигнорированы.
